<script type="text/javascript">
  RED.nodes.registerType('prtg-config', {
    category: 'config',
    defaults: {
      host: {
        value: "localhost",
        required: true
      },
      port: {
        value: 5050,
        required: true,
        validate: RED.validators.number()
      },
      usetls: {
          value: false
      },
      ignoreUnsafeEndpoints:{
        value: true
      },
      followredirect: {
        value: true
      }
    },
    label: function () {
      return this.host + ":" + this.port;
    },
    oneditprepare: function() {
      this.usetls=this.checked
      $('#node-config-input-usetls').change(function(){$('#node-config-input-port').val(this.checked?5051:5050)})      
    }
  });
</script>

<script type="text/x-red" data-template-name="prtg-config">
  <div class="form-row node-input-host">
    <label for="node-config-input-host"><i class="fa fa-globe"></i> <span>Server</span></label>
    <input class="input-append-left input-error" type="text" id="node-config-input-host" style="width:40%;" dir="" placeholder="e.g. localhost">
    <label for="node-config-input-port" style="margin-left:20px; width:43px; "> <span>Port</span></label>
    <input type="text" id="node-config-input-port" style="width:55px" dir="" placeholder="Port">
  </div>
  <div class="form-row">
    <input type="checkbox" id="node-config-input-usetls" style="display: inline-block; width: auto; vertical-align: top;">
    <label for="node-config-input-usetls" style="width: auto">Enable secure (SSL/TLS) connection</label>
  </div>
  <div class="form-row">
    <input type="checkbox" id="node-config-input-ignoreUnsafeEndpoints" style="display: inline-block; width: auto; vertical-align: top;">
    <label for="node-config-input-ignoreUnsafeEndpoints" style="width: auto">Ignore endpoints with unsafe certificates</label>
  </div>
  <div class="form-row">
    <input type="checkbox" id="node-config-input-followredirect" style="display: inline-block; width: auto; vertical-align: top;">
    <label for="node-config-input-followredirect" style="width: auto">Follow redirects</label>
  </div>
</script>
<script type="text/x-red" data-help-name="prtg-config">
  <p>
      This node represents a <a href="https://www.paessler.com/prtg">PRTG</a> endpoint configuration.
  </p>

  <h3>Inputs</h3>
  <dl class="message-properties">
    <dt>host
        <span class="property-type">string</span>
    </dt>
    <dd> Hostname or IP address under which the probe system in PRTG is reachable. 
    </dd>
    <dt>port
      <span class="property-type">string</span>
    </dt>
    <dd> Port on the probe system in PRTG, on which the configured sensor listens.
    </dd>
    <dt>usetls
      <span class="property-type">boolean</span>
    </dt>
    <dd> Define whether to use an SSL/TLS connection.
    </dd>
    <dt>ignoreUnsafeEndpoints
      <span class="property-type">boolean</span>
    </dt>
    <dd> Define whether to ignore errors from endpoints with self-signed certificates.
    </dd>
    <dt>followredirect
      <span class="property-type">boolean</span>
    </dt>
    <dd> Define whether to follow redirects. 
    </dd>
   </dl>
  <h3>References</h3>
    <ul>
        <li><a href="https://www.paessler.com/prtg">PRTG</a></li>
        <li><a href="https://github.com/PaesslerAG/node-red-contrib-prtg">GitHub</a> - the nodes github repository</li>
        <li><a href="https://kb.paessler.com/en/topic/87520">Paessler Knowledge Base: How can I monitor IoT and IIoT environments with PRTG and Node-RED?</a></li>
    </ul>        
</script>
